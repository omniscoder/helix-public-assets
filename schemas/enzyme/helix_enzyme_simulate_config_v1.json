{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://omniscoder.github.io/Helix/schemas/enzyme/helix_enzyme_simulate_config_v1.json",
  "title": "Helix Enzyme Simulate Config v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema", "runs"],
  "properties": {
    "schema": {
      "type": "object",
      "additionalProperties": false,
      "required": ["kind", "version"],
      "properties": {
        "kind": {"const": "helix.enzyme.simulate_config"},
        "version": {"type": "integer", "const": 1}
      }
    },
    "session_id": {"type": "string"},
    "project_id": {"type": "string"},
    "author": {"type": "string"},
    "program_id": {"type": "string"},
    "runs": {
      "type": "array",
      "minItems": 1,
      "items": {"$ref": "#/$defs/run_spec"}
    }
  },
  "$defs": {
    "reaction_representation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["kind", "value"],
      "properties": {
        "kind": {"type": "string", "enum": ["smarts", "rxn_smiles", "ec_number"]},
        "value": {"type": "string", "minLength": 1},
        "substrate_smiles": {"type": "string", "minLength": 1},
        "product_smiles": {"type": "string", "minLength": 1}
      },
      "allOf": [
        {
          "if": {"properties": {"kind": {"const": "ec_number"}}},
          "then": {"required": ["substrate_smiles", "product_smiles"]}
        }
      ]
    },
    "reaction_object": {
      "type": "object",
      "additionalProperties": false,
      "required": ["reaction_id", "representation"],
      "properties": {
        "reaction_id": {"type": "string", "minLength": 1},
        "representation": {"$ref": "#/$defs/reaction_representation"},
        "substrate": {
          "type": "object",
          "additionalProperties": false,
          "required": ["smiles"],
          "properties": {"smiles": {"type": "string", "minLength": 1}, "name": {"type": "string"}}
        },
        "product": {
          "type": "object",
          "additionalProperties": false,
          "required": ["smiles"],
          "properties": {"smiles": {"type": "string", "minLength": 1}, "name": {"type": "string"}}
        },
        "cofactor_requirements": {"type": "array", "items": {"type": "string", "minLength": 1}}
      }
    },
    "environment_object": {
      "type": "object",
      "additionalProperties": false,
      "required": ["ph", "temperature_c", "assumption_domain"],
      "properties": {
        "ph": {"type": "number"},
        "temperature_c": {"type": "number"},
        "ionic_strength_mM": {"type": "number"},
        "solvent": {"type": "string"},
        "cofactors_available": {"type": "array", "items": {"type": "string", "minLength": 1}},
        "assumption_domain": {"type": "string", "minLength": 1}
      }
    },
    "constraints_object": {
      "type": "object",
      "additionalProperties": false,
      "required": ["sequence"],
      "properties": {
        "scaffold": {
          "type": "object",
          "additionalProperties": true,
          "required": ["kind", "value"],
          "properties": {"kind": {"type": "string"}, "value": {"type": "string"}}
        },
        "sequence": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "length_range": {
              "type": "array",
              "minItems": 2,
              "maxItems": 2,
              "items": {"type": "integer", "minimum": 1}
            },
            "fixed_positions": {
              "type": "object",
              "additionalProperties": false,
              "patternProperties": {
                "^[0-9]+$": {"type": "string", "pattern": "^[ACDEFGHIKLMNPQRSTVWY]$"}
              }
            },
            "forbidden_motifs": {"type": "array", "items": {"type": "string", "minLength": 1}}
          }
        },
        "active_site": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "residue_set": {"type": "array", "items": {"type": "integer", "minimum": 1}},
            "geometry_constraints": {"type": "object", "additionalProperties": true}
          }
        },
        "manufacturability": {"type": "object", "additionalProperties": true}
      }
    },
    "search_object": {
      "type": "object",
      "additionalProperties": false,
      "required": ["algorithm", "budget", "seed", "determinism_class"],
      "properties": {
        "algorithm": {"type": "string", "enum": ["ga", "mcmc", "beam", "enumerate"]},
        "budget": {
          "type": "object",
          "additionalProperties": false,
          "required": ["iterations", "candidates"],
          "properties": {
            "iterations": {"type": "integer", "minimum": 1},
            "candidates": {"type": "integer", "minimum": 1}
          }
        },
        "seed": {"type": "integer"},
        "determinism_class": {"type": "string", "enum": ["D0", "D1", "D2"]}
      }
    },
    "run_spec": {
      "type": "object",
      "additionalProperties": false,
      "required": ["task_type", "reaction", "environment", "constraints", "search", "scoring_profile"],
      "properties": {
        "run_id": {"type": "string"},
        "task_type": {"type": "string", "enum": ["single_enzyme", "cascade"]},
        "reaction": {"$ref": "#/$defs/reaction_object"},
        "environment": {"$ref": "#/$defs/environment_object"},
        "constraints": {"$ref": "#/$defs/constraints_object"},
        "search": {"$ref": "#/$defs/search_object"},
        "scoring_profile": {"type": "string", "minLength": 1},
        "metadata": {"type": "object", "additionalProperties": true}
      }
    }
  }
}
